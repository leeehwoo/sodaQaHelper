<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
		<meta http-equiv="Pragma" content="no-cache">
		<meta charset="UTF-8">
		<title>Beauty Recipes</title>
		<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
		<script type="text/javascript" src="jquery.qrcode.js"></script>
		<script type="text/javascript" src="qrcode.js"></script>
		<link rel="stylesheet" href="./schemePageStyle.css">
        <script src="https://kit.fontawesome.com/3d6daedbc5.js" crossorigin="anonymous"></script>
		<style>
			#showQrCode{position:relative;}
			#qrUl{position:absolute;top:20px;left:120px;}
			#qrUl li{height:100px;list-style:none;}
            #showQrCodeDiv{position:absolute;left: 20px;}
		</style>
	</head>

	<body>
		<div id="mainTitleArea">
			<h2>Beauty Recipes Scheme (Tianyan Beta)</h2>
			<i class="fas fa-home" id="moveHome" onclick="location.href='sodaqahelper.html'"></i>
		</div>
		<div id="titleAreaTianyan">
			<h3>Scheme Select</h3>
		</div>
		<div id="optionArea">
			<button id="mainCamera" onclick="location.href='mainCameraPageTianyanBeta.html'">Main Camera</button>
			<button id="discover" onclick="location.href='discoverPageTianyanBeta.html'">Discover</button>
			<button id="beautyRecipe" onclick="location.href='beautyRecipePageTianyanBeta.html'">Beauty Recipe</button>
			<button id="edit" onclick="location.href='editPageTianyanBeta.html'">Edit</button>
			<button id="beauty" onclick="location.href='beautyPageTianyanBeta.html'">Beauty</button>
			<button id="flutter" onclick="location.href='flutterPageTianyanBeta.html'">Flutter</button>
		</div>
		<div id="titleAreaTianyan">
			<h3>Style</h3>
		</div>
		<div id="optionArea">
			Style ID : <input type="number" id="beautyRecipeStyleId">
			<i class="fas fa-plus setStyle" id="beautyRecipeStyleIdSet"></i>
            <i class="fas fa-redo-alt unsetStyle" id="beautyRecipeStyleIdUnset"></i>
		</div>
		<div id="titleAreaTianyan">
			<h3>Filter</h3>
		</div>
		<div id="optionArea">
			Filter ID : <input type="number" id="beautyRecipeFilterId">
			<i class="fas fa-plus setStyle" id="beautyRecipeFilterIdSet"></i>
            <i class="fas fa-redo-alt unsetStyle" id="beautyRecipeFilterIdUnset"></i>
		</div>
		<div id="titleAreaTianyan">
			<h3>Face Shape</h3>
		</div>
		<div id="optionArea">
			<select name="beautyRecipeFaceShape" id="beautyRecipeFaceShape">
				<option value="original">original</option>
				<option value="natural">natural</option>
				<option value="baby">baby</option>
				<option value="slim">slim</option>
				<option value="beauty">beauty</option>
				<option value="basic">basic</option>
				<option value="daily">daily</option>
			</select>
			<i class="fas fa-plus setStyle" id="beautyRecipeFaceShapeSet"></i>
            <i class="fas fa-redo-alt unsetStyle" id="beautyRecipeFaceShapeUnset"></i>
			 / Intensity : <input type="number" id="beautyRecipeFaceShapeIntensity" max="100">
			<i class="fas fa-plus setStyle" id="beautyRecipeFaceShapeIntensitySet"></i>
            <i class="fas fa-redo-alt unsetStyle" id="beautyRecipeFaceShapeIntensityUnset"></i>
		</div>
		<div id="titleAreaTianyan">
			<h3>Beauty</h3>
		</div>
		<div id="optionArea">
			<select name="beautyRecipeBeautyKeyname" id="beautyRecipeBeauty">
				<option value="bodyslim">bodyslim</option>
				<option value="head">head</option>
				<option value="smooth">smooth</option>
				<option value="balance">balance</option>
				<option value="clear">clear</option>
				<option value="toneup">toneup</option>
				<option value="enlarge">enlarge</option>
				<option value="narrow">narrow</option>
				<option value="wrinkle">wrinkle</option>
				<option value="cheekbone">cheekbone</option>
				<option value="slim">slim</option>
				<option value="short">short</option>
				<option value="brow">brow</option>
				<option value="clarity">clarity</option>
				<option value="eyebag">eyebag</option>
				<option value="teeth">teeth</option>
				<option value="lift">lift</option>
				<option value="chin">chin</option>
				<option value="jawbone">jawbone</option>
				<option value="span">span</option>
				<option value="alar">alar</option>
				<option value="noselength">noselength</option>
				<option value="temple">temple</option>
				<option value="vshape">vshape</option>
				<option value="position">position</option>
				<option value="eyesize">eyesize</option>
				<option value="eyewidth">eyewidth</option>
				<option value="corner">corner</option>
				<option value="pupil">pupil</option>
				<option value="inner">inner</option>
				<option value="eyelength">eyelength</option>
				<option value="under">under</option>
				<option value="eyetail">eyetail</option>
				<option value="plim">plim</option>
				<option value="nose">nose</option>
				<option value="bridge">bridge</option>
				<option value="radixnasi">radixnasi</option>
				<option value="tip">tip</option>
				<option value="mouth">mouth</option>
				<option value="philtrum">philtrum</option>
				<option value="lipwidth">lipwidth</option>
				<option value="upperlip">upperlip</option>
				<option value="lowerlip">lowerlip</option>
				<option value="mlip">mlip</option>
				<option value="smile">smile</option>
				<option value="thick">thick</option>
				<option value="eyebrowlift">eyebrowlift</option>
				<option value="glabella">glabella</option>
				<option value="eyebrow">eyebrow</option>
				<option value="shape">shape</option>
				<option value="front">front</option>
				<option value="behind">behind</option>
			</select>
			/ Intensity : <input type="number" id="beautyRecipeBeautyIntensity" max="100">
			<i class="fas fa-plus setStyle" id="beautyRecipeBeautySet"></i>
            <i class="fas fa-redo-alt unsetStyle" id="beautyRecipeBeautyUnset"></i>
		</div>
		<div id="titleAreaTianyan">
			<h3>Option</h3>
		</div>
		<div id="optionArea">
			- Compare Button >>
			<select name="compare" id="compare">
				<option value="false">Off</option>
				<option value="true">On</option>
			</select>
			<i class="fas fa-redo-alt unsetStyle" id="compareBtnUnset"></i>
		</div>
		<div id="titleAreaTianyan">
			<h2>* Scheme</h2>
		</div>
		<input id="mainUrl" readonly style="width: 900px;">
		<br>
		<br>
		<i class="fas fa-copy copyStyle" id="schemeCopy"></i>
		<br>
		<div id="titleAreaTianyan">
			<h2>* QR Code</h2>
		</div>
		<i class="fas fa-qrcode qrcodeStyle" id="addQrcode" value="Show QR Code" onclick="actionAdd()"></i>
        <i class="fas fa-redo-alt resetStyle" id="reset" value="Reset"></i>
		<br>
		<br>
		<div id="showQrCode">
			<div id="showQrCodeDiv"></div>
			<ul id="qrUl"><ul>
		</div>

		<script>
			const appMain = {
				url: '',
				style: '',
				filter: '',
				faceShape: '',
				faceShpaeIntensity: '',
				beauty: [],
				allUrl: '',
				optionCompare: '',
			}

			$(function () {
				appMain.url = "tianyanb://";

				setUrl();

				$("#appSelect").change(function() {
					appMain.url = $(this).val() + "://";
					setUrl();
				});

				$("#beautyRecipeStyleIdSet").click(function () {
					var styleId = $("#beautyRecipeStyleId").val();
					if (styleId === '') {
						return false;
					}
					appMain.style = 'styleId=' + styleId;
					setUrl();
				});

				$("#beautyRecipeStyleIdUnset").click(function () {
					if(appMain.style.indexOf("styleId") !== -1) {
						appMain.style = '';
						setUrl();
					}
				});

				$("#beautyRecipeFilterIdSet").click(function () {
					var filterId = $("#beautyRecipeFilterId").val();
					if (filterId === '') {
						return false;
					}
					appMain.filter = 'filterId=' + filterId;
					setUrl();
				});

				$("#beautyRecipeFilterIdUnset").click(function () {
					if(appMain.filter.indexOf("filterId") !== -1) {
						appMain.filter = '';
						setUrl();
					}
				});

				$("#beautyRecipeFaceShape").change(function () {
					var face = $(this).val();
					appMain.faceShape = 'faceShape=' + face;
					setUrl();
				});

				$("#beautyRecipeFaceShapeSet").click(function () {
					var face = $("#beautyRecipeFaceShape").val();
					appMain.faceShape = 'faceShape=' + face;
					setUrl();
				});

				$("#beautyRecipeFaceShapeUnset").click(function () {
					appMain.faceShape = '';
					setUrl();
				});

				$("#beautyRecipeFaceShapeIntensitySet").click(function () {
					var faceIntensity = $("#beautyRecipeFaceShapeIntensity").val();
					if (faceIntensity === '') {
						return false;
					}
					appMain.faceShpaeIntensity = 'faceShapeIntensity=' + faceIntensity;
					setUrl();
				});

				$("#beautyRecipeFaceShapeIntensityUnset").click(function () {
					appMain.faceShpaeIntensity = '';
					setUrl();
				});

				$("#beautyRecipeBeautySet").click(function () {
					var beautySelect = $("#beautyRecipeBeauty").val();
					var beautyIntensity = $("#beautyRecipeBeautyIntensity").val();

					if (beautyIntensity === '') {
						return false;
					}

					var addKeynameIntensity = appMain.beauty.some(p => p.name === beautySelect);

					if (addKeynameIntensity) {
						var i = appMain.beauty.findIndex(p => p.name === beautySelect);
						appMain.beauty[i].val = beautyIntensity;
					} else {
						appMain.beauty.push({ 'name' : beautySelect, 'val' : beautyIntensity});
					}

					setUrl();
				});

				$("#beautyRecipeBeautyUnset").click(function () {
					var beautySelect = $("#beautyRecipeBeauty").val();
					for (var i = 0; i < appMain.beauty.length; i++) {
						if (appMain.beauty[i].name === beautySelect) {
							appMain.beauty.splice(i, 1);
						}
					}
					setUrl();
				});

				$("#compare").change(function () {
					var compareOption = $(this).val();
					appMain.optionCompare = 'comparebutton=' + compareOption;
					setUrl();
				})

				$("#compareBtnUnset").click(function (){
					appMain.optionCompare = '';
					setUrl();
				});

				$("#mainUrl").click(function () {
					var url = $(this).val();
					window.open(url);
				});
			})

			function setUrl() {
				const param = [appMain.style, appMain.filter, appMain.faceShape, appMain.faceShpaeIntensity, appMain.beauty, appMain.optionCompare]
				console.log(param);
				var all = appMain.url + "eventCamera?type=beautyRecipe";
				for (var i = 0; i < param.length; i++) {
					if (Array.isArray(param[i])) {
						for (var j = 0; j < param[i].length; j++) {
							all += '&' + param[i][j].name + '=' +param[i][j].val;
						}
					} else {
						if (param[i] === '') {
						} else {
							all += '&' + param[i];
						}
					}
				}
				$("#mainUrl").val(all);
				appMain.allUrl = all;
			}

			//qrcode 보기
			$("#addQrcode").click(function () {
				jQuery("#showQrCode #showQrCodeDiv").qrcode({
					render: "table",
					width: 100,
					height: 100,
					text: $("#mainUrl").val()
				});
			})

			function actionAdd(){
				var textAdd = $("#mainUrl").val(); //입력할 글씨
				var qrUl = $("#qrUl"); //ul_list선언
				qrUl.append("<br>"+"<li>"+textAdd+"</li>"); //ul_list안쪽에 li추가
                var space = $("#showQrCodeDiv");
                space.append("<br>");
				window.scrollTo(0,document.body.scrollHeight);
			}

			//qrcode reset
			$("#reset").click(function () {
				$("#showQrCode #showQrCodeDiv").empty();
				$("#qrUl").empty();
			})

			//scheme copy
			jQuery("#schemeCopy").click (
				function() {
					var urlInfo = document.getElementById("mainUrl");
					urlInfo.select();
					document.execCommand("Copy");
					alert("Add scheme to clipboard!")
				}
			)
		</script>
	</body>
</html>